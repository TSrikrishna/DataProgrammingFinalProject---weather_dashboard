<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', { 'packages': ['corechart'] });
        google.charts.setOnLoadCallback(drawCharts);

        function drawCharts() {
            fetch('/api/weather')
                .then(response => response.json())
                .then(data => {
                    var temperatureDataBarrie = new google.visualization.DataTable();
                    var temperatureDataToronto = new google.visualization.DataTable();
                    var humidityDataBarrie = new google.visualization.DataTable();
                    var humidityDataToronto = new google.visualization.DataTable();

                    temperatureDataBarrie.addColumn('datetime', 'Time');
                    temperatureDataBarrie.addColumn('number', 'Temperature');
                    temperatureDataToronto.addColumn('datetime', 'Time');
                    temperatureDataToronto.addColumn('number', 'Temperature');

                    humidityDataBarrie.addColumn('datetime', 'Time');
                    humidityDataBarrie.addColumn('number', 'Humidity');
                    humidityDataToronto.addColumn('datetime', 'Time');
                    humidityDataToronto.addColumn('number', 'Humidity');

                    data.forEach(row => {
                        var dateTime = new Date(row.minute);
                        if (row.city === 'Barrie') {
                            temperatureDataBarrie.addRow([dateTime, parseFloat(row.temperature)]);
                            humidityDataBarrie.addRow([dateTime, parseFloat(row.humidity)]);
                        } else if (row.city === 'Toronto') {
                            temperatureDataToronto.addRow([dateTime, parseFloat(row.temperature)]);
                            humidityDataToronto.addRow([dateTime, parseFloat(row.humidity)]);
                        }
                    });

                    var temperatureOptionsBarrie = {
                        title: 'Temperature Data for Barrie',
                        hAxis: { title: 'Time', format: 'HH:mm' },
                        vAxis: { title: 'Temperature (°C)' },
                        legend: { position: 'bottom' },
                        series: { 0: { pointShape: 'circle', lineDashStyle: [4, 4], opacity: 0.3 } }
                    };

                    var temperatureOptionsToronto = {
                        title: 'Temperature Data for Toronto',
                        hAxis: { title: 'Time', format: 'HH:mm' },
                        vAxis: { title: 'Temperature (°C)' },
                        legend: { position: 'bottom' },
                        series: { 0: { pointShape: 'circle', lineDashStyle: [4, 4], opacity: 0.3 } }
                    };

                    var humidityOptionsBarrie = {
                        title: 'Humidity Data for Barrie',
                        hAxis: { title: 'Time', format: 'HH:mm' },
                        vAxis: { title: 'Humidity (%)' },
                        legend: { position: 'bottom' },
                        series: { 0: { pointShape: 'circle' } }
                    };

                    var humidityOptionsToronto = {
                        title: 'Humidity Data for Toronto',
                        hAxis: { title: 'Time', format: 'HH:mm' },
                        vAxis: { title: 'Humidity (%)' },
                        legend: { position: 'bottom' },
                        series: { 0: { pointShape: 'circle' } }
                    };

                    var tempChartBarrie = new google.visualization.LineChart(document.getElementById('temp_chart_barrie'));
                    tempChartBarrie.draw(temperatureDataBarrie, temperatureOptionsBarrie);

                    var tempChartToronto = new google.visualization.LineChart(document.getElementById('temp_chart_toronto'));
                    tempChartToronto.draw(temperatureDataToronto, temperatureOptionsToronto);

                    var humidityChartBarrie = new google.visualization.ColumnChart(document.getElementById('humidity_chart_barrie'));
                    humidityChartBarrie.draw(humidityDataBarrie, humidityOptionsBarrie);

                    var humidityChartToronto = new google.visualization.ColumnChart(document.getElementById('humidity_chart_toronto'));
                    humidityChartToronto.draw(humidityDataToronto, humidityOptionsToronto);
                });
        }
    </script>
</head>
<body>
    <h1>Weather Dashboard</h1>
    <div id="temp_chart_barrie" style="width: 100%; height: 500px;"></div>
    <div id="temp_chart_toronto" style="width: 100%; height: 500px;"></div>
    <div id="humidity_chart_barrie" style="width: 100%; height: 500px;"></div>
    <div id="humidity_chart_toronto" style="width: 100%; height: 500px;"></div>
</body>
</html>
